Game of Trees (Got) is a version control system which prioritizes ease
of use and simplicity over flexibility (https://gameoftrees.org)

Got is still under development; it is being developed exclusively
on OpenBSD and its target audience are OpenBSD developers. Got is
ISC-licensed and was designed with pledge(2) and unveil(2) in mind.

Got uses Git repositories to store versioned data. At present, Got
supports local version control operations only. Git can be used
for any functionality which has not yet been implemented in Got.
It will always remain possible to work with both Got and Git on
the same repository.

To compile the Got client tool suite on OpenBSD, run:

 $ make obj
 $ make
 $ make install

This will install the following commands:

 got, the command line interface
 tog, an ncurses-based interactive Git repository browser
 several helper programs from the libexec directory
 man pages (only installed if building sources from a Got release tarball)

A Got release tarball will install files under /usr/local by default.
A build started in Got's Git repository will install files under ~/bin.

Tests will pass only after 'make install' because they rely on installed
binaries in $PATH. Tests in the cmdline directory currently depend on git(1).
Tests which use the got clone, fetch, and send commands will fail if
'ssh 127.0.0.1' does not succeed non-interactively.

 $ doas pkg_add git
 $ make regress

To test with packed repositories, run:

 $ make regress GOT_TEST_PACK=1

Because got unveils the /tmp directory by default using the /tmp directory
for test data can hide bugs. However, /tmp remains the default because
there is no better alternative that works out of the box. In order to
store test data in a directory other than /tmp, such as ~/got-test, run:

 $ mkdir ~/got-test
 $ make regress GOT_TEST_ROOT=~/got-test

Man page files in the Got source tree can be viewed with 'man -l':

 $ man -l got/got.1
 $ man -l got/git-repository.5
 $ man -l got/got-worktree.5
 $ man -l tog/tog.1

EXAMPLES in got.1 contains a quick-start guide for OpenBSD developers.


To compile the Got server tool suite on OpenBSD, run:

 $ make obj
 $ make server
 $ make server-install

This will install the following commands:

 gotd, the repository server program
 gotctl, the server control utility
 gotsh, the login shell for users accessing the server via the network

See the following manual page files for information about server setup:

 $ man -l gotd/gotd.8
 $ man -l gotd/gotd.conf.5
 $ man -l gotctl/gotctl.8
 $ man -l gotsh/gotsh.1

See regress/gotd/README for information about running the server test suite.


Game of Trees Web (Gotweb) is a CGI program which displays repository data
and is designed to work with httpd(8) and slowcgi(8). It requires the Kristaps
Dzonsons kcgi library, version 0.12.0 or greater.

To compile gotweb on OpenBSD, run:

 # pkg_add kcgi
 $ make web
 # make web-install

This will create the following files:
  the CGI program /var/www/cgi-bin/gotweb/gotweb
  helper programs from the libexec directory in /var/www/cgi-bin/gotweb/libexec
  several template files in /var/www/cgi-bin/gw_tmpl/
  html, css, and image files in /var/www/htdocs/gotweb/
  the directory /var/www/got/tmp/
  man pages (only installed if building sources from a Got release tarball)

Documentation is available in manual pages:

 $ man -l gotweb/gotweb.8
 $ man -l gotweb/gotweb.conf.5


Got can be built with profiling enabled to debug performance issues.
Note that profiled builds cannot make use of pledge(2).
Profiling should only be enabled for one program at a time. Otherwise,
multiple programs will attempt to write to the 'gmon.out' file in the
current working directory.

For example, to compile got-read-pack with profiling enabled:

  $ cd libexec/got-read-pack
  $ make clean
  $ make PROFILE=1
  $ make install

Running any Got command which ends up using got-read-pack should now
produce the file 'gmon.out' in the current working directory.
The gprof2dot program can be used to generate a profile graph:

  $ doas pkg_add gprof2dot graphviz
  $ gprof ~/bin/got-read-pack gmon.out | gprof2dot | dot -T png > profile.png

As another example, to compile gotweb with profiling enabled:

  $ cd gotweb
  $ make clean
  $ make PROFILE=1 gotweb
  $ make # compile remaining gotweb binaries as usual
  $ doas make install
  $ doas chown www /var/www/cgi-bin/gotweb/

After loading a gotweb page in the browser, there should now
be a gmon.out file next to the gotweb binary:

$ ls -l /var/www/cgi-bin/gotweb/
total 6088
-rw-r--r--  1 www   daemon   427642 Jun 17 22:04 gmon.out
-rwxr-xr-x  1 www   www     2630488 Jun 17 22:03 gotweb
drwxr-xr-x  2 root  daemon      512 Jun 17 22:03 gw_tmpl
drwxr-xr-x  2 root  daemon      512 Jun 17 22:03 libexec


Guidelines for reporting problems:

All problem/bug reports should include a reproduction recipe in form of a
shell script which starts out with an empty repository and runs a series of
Got and/or Git commands to trigger the problem, be it a crash or some other
undesirable behaviour.

The regress/cmdline directory contains plenty of example scripts.
An ideal reproduction recipe is written as an xfail ("expected failure")
regression test. For a real-world example of an xfail test, see commits
4866d0842a2b34812818685aaa31d3e0a966412d and
2b496619daecc1f25b1bc0c53e01685030dc2c74 in Got's history.

Please take this request very seriously; Ask for help with writing your
regression test before asking for your problem to be fixed. Time invested
in writing a regression test saves time wasted on back-and-forth discussion
about how the problem can be reproduced. A regression test will need to be
written in any case to verify a fix and prevent the problem from resurfacing.

It is also possible to write test cases in C. Various examples of this
exist in the regress/ directory. Most such tests are unit tests; it is
unlikely that a problem found during regular usage will require a test
to be written in C.

Some areas of code, such as the tog UI, are not covered by automated tests.
Please always try to find a way to trigger your problem via the command line
interface before reporting a problem without a written test case included.
If writing an automated test really turns out to be impossible, please
explain in very clear terms how the problem can be reproduced.

Mail problem reports to: gameoftrees@openbsd.org


Guidelines for submitting patches:

Mail patches to: gameoftrees@openbsd.org
Pull requests via any Git hosting sites will likely be overlooked.
Please keep the intended target audience in mind when contributing to Got.


Subscribing to the gameoftrees@openbsd.org mailing list:

The mailing list is used for patch reviews, bug reports, and user questions.
To subscribe, send mail to majordomo@openbsd.org with a message body of:
subscribe gameoftrees

See https://www.openbsd.org/mail.html for more information.
